{"version":3,"sources":["../../api/test/orders_test.js"],"names":["process","env","NODE_ENV","assert","chai","expect","use","chaiHttp","user0_Payload","name","email","phone","password","user1_Payload","admin0_Payload","admin1_Payload","before","done","User","create","then","Admin","describe","it","request","server","get","res","to","have","status","equal","body","catch","err","console","log","message","findOne","where","admin","id","token","jwt","sign","isAdmin","secret","expiresIn","set","errors","Meal","price","imageUrl","adminId","meal","post","send","mealId","quantity","user","user2Payload","OrderItem","userId","orderItem","API_PREFIX","app","put","action","newMenu","push","Menu","meals","JSON","stringify","menu","parse","delivery_address","after","destroy"],"mappings":";;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;;;;;AAZAA,OAAO,CAACC,GAAR,CAAYC,QAAZ,GAAuB,MAAvB;IAaQC,M,GAAmBC,a,CAAnBD,M;IAAQE,M,GAAWD,a,CAAXC,M;;AAChBD,cAAKE,GAAL,CAASC,iBAAT;;AAEA,IAAMC,aAAa,GAAG;AACpBC,EAAAA,IAAI,EAAE,YADc;AAEpBC,EAAAA,KAAK,EAAE,gBAFa;AAGpBC,EAAAA,KAAK,EAAE,aAHa;AAIpBC,EAAAA,QAAQ,EAAE;AAJU,CAAtB;AAOA,IAAMC,aAAa,GAAG;AACpBJ,EAAAA,IAAI,EAAE,WADc;AAEpBC,EAAAA,KAAK,EAAE,eAFa;AAGpBC,EAAAA,KAAK,EAAE,aAHa;AAIpBC,EAAAA,QAAQ,EAAE;AAJU,CAAtB;AAOA,IAAME,cAAc,GAAG;AACrBL,EAAAA,IAAI,EAAE,aADe;AAErBE,EAAAA,KAAK,EAAE,aAFc;AAGrBD,EAAAA,KAAK,EAAE,iBAHc;AAIrBE,EAAAA,QAAQ,EAAE;AAJW,CAAvB;AAOA,IAAMG,cAAc,GAAG;AACrBN,EAAAA,IAAI,EAAE,eADe;AAErBE,EAAAA,KAAK,EAAE,aAFc;AAGrBD,EAAAA,KAAK,EAAE,kBAHc;AAIrBE,EAAAA,QAAQ,EAAE;AAJW,CAAvB;AAOAI,MAAM,CAAC,UAAAC,IAAI,EAAI;AACbC,gBAAKC,MAAL,CAAYX,aAAZ,EACGY,IADH,CACQ,YAAM;AACV,WAAOC,eAAMF,MAAN,CAAaL,cAAb,CAAP;AACD,GAHH,EAIGM,IAJH,CAIQ,YAAM;AACVH,IAAAA,IAAI;AACL,GANH;AAOD,CARK,CAAN;AAUAK,QAAQ,CAAC,gCAAD,EAAmC,YAAM;AAC/CC,EAAAA,EAAE,yDAAyD,UAAAN,IAAI,EAAI;AACjEb,kBACGoB,OADH,CACWC,YADX,EAEGC,GAFH,mBAGGN,IAHH,CAGQ,UAAAO,GAAG,EAAI;AACXtB,MAAAA,MAAM,CAACsB,GAAD,CAAN,CAAYC,EAAZ,CAAeC,IAAf,CAAoBC,MAApB,CAA2B,GAA3B;AACA3B,MAAAA,MAAM,CAAC4B,KAAP,CAAaJ,GAAG,CAACK,IAAJ,CAASF,MAAtB,EAA8B,OAA9B;AACAb,MAAAA,IAAI;AACL,KAPH,EAQGgB,KARH,CAQS,UAAAC,GAAG;AAAA,aAAIC,OAAO,CAACC,GAAR,CAAY,aAAZ,EAA2BF,GAAG,CAACG,OAA/B,CAAJ;AAAA,KARZ;AASD,GAVC,CAAF;AAWAd,EAAAA,EAAE,wDAAwD,UAAAN,IAAI,EAAI;AAChEI,mBAAMiB,OAAN,CAAc;AAAEC,MAAAA,KAAK,EAAE;AAAE7B,QAAAA,KAAK,EAAEI,cAAc,CAACJ;AAAxB;AAAT,KAAd,EACGU,IADH,CACQ,UAAAoB,KAAK,EAAI;AAAA,UACLC,EADK,GACsBD,KADtB,CACLC,EADK;AAAA,UACDhC,IADC,GACsB+B,KADtB,CACD/B,IADC;AAAA,UACKC,KADL,GACsB8B,KADtB,CACK9B,KADL;AAAA,UACYC,KADZ,GACsB6B,KADtB,CACY7B,KADZ;;AAEb,UAAM+B,KAAK,GAAGC,sBAAIC,IAAJ,CACZ;AACEJ,QAAAA,KAAK,EAAE;AAAEC,UAAAA,EAAE,EAAFA,EAAF;AAAMhC,UAAAA,IAAI,EAAJA,IAAN;AAAYC,UAAAA,KAAK,EAALA,KAAZ;AAAmBC,UAAAA,KAAK,EAALA;AAAnB,SADT;AAEEkC,QAAAA,OAAO,EAAE;AAFX,OADY,EAKZC,YALY,EAMZ;AACEC,QAAAA,SAAS,EAAE;AADb,OANY,CAAd;;AAUA3C,oBACGoB,OADH,CACWC,YADX,EAEGC,GAFH,kBAGGsB,GAHH,CAGO,eAHP,mBAGkCN,KAHlC,GAIGtB,IAJH,CAIQ,UAAAO,GAAG,EAAI;AACXtB,QAAAA,MAAM,CAACsB,GAAD,CAAN,CAAYC,EAAZ,CAAeC,IAAf,CAAoBC,MAApB,CAA2B,GAA3B;AACA3B,QAAAA,MAAM,CAAC4B,KAAP,CAAaJ,GAAG,CAACK,IAAJ,CAASF,MAAtB,EAA8B,SAA9B;AACAb,QAAAA,IAAI;AACL,OARH,EASGgB,KATH,CASS,UAAAC,GAAG;AAAA,eAAIC,OAAO,CAACC,GAAR,CAAY,aAAZ,EAA2BF,GAAG,CAACG,OAA/B,CAAJ;AAAA,OATZ;AAUD,KAvBH,EAwBGJ,KAxBH,CAwBS,UAAAC,GAAG;AAAA,aAAIC,OAAO,CAACC,GAAR,CAAYF,GAAG,CAACe,MAAJ,CAAW,CAAX,EAAcxC,IAA1B,CAAJ;AAAA,KAxBZ;AAyBD,GA1BC,CAAF;AA2BD,CAvCO,CAAR;AAyCAa,QAAQ,CAAC,kCAAD,EAAqC,YAAM;AACjDD,iBAAMF,MAAN,CAAaL,cAAb,EACGM,IADH,CACQ,UAAAoB,KAAK,EAAI;AACb,WAAOU,eAAK/B,MAAL,CAAY;AACjBV,MAAAA,IAAI,EAAE,YADW;AAEjB0C,MAAAA,KAAK,EAAE,IAFU;AAGjBC,MAAAA,QAAQ,EAAE,UAHO;AAIjBC,MAAAA,OAAO,EAAEb,KAAK,CAACC;AAJE,KAAZ,CAAP;AAMD,GARH,EASGrB,IATH,CASQ,UAAAkC,IAAI,EAAI;AACZ/B,IAAAA,EAAE,uDAAuD,UAAAN,IAAI,EAAI;AAC/Db,oBACGoB,OADH,CACWC,YADX,EAEG8B,IAFH,mBAGGC,IAHH,CAGQ;AACJC,QAAAA,MAAM,EAAEH,IAAI,CAACb,EADT;AAEJiB,QAAAA,QAAQ,EAAE;AAFN,OAHR,EAOGtC,IAPH,CAOQ,UAAAO,GAAG,EAAI;AACXtB,QAAAA,MAAM,CAACsB,GAAD,CAAN,CAAYC,EAAZ,CAAeC,IAAf,CAAoBC,MAApB,CAA2B,GAA3B;AACA3B,QAAAA,MAAM,CAAC4B,KAAP,CAAaJ,GAAG,CAACK,IAAJ,CAASF,MAAtB,EAA8B,OAA9B;AACAb,QAAAA,IAAI;AACL,OAXH,EAYGgB,KAZH,CAYS,UAAAC,GAAG;AAAA,eAAIC,OAAO,CAACC,GAAR,CAAY,cAAZ,EAA4BF,GAAG,CAACG,OAAhC,CAAJ;AAAA,OAZZ;AAaD,KAdC,CAAF;AAgBAd,IAAAA,EAAE,2DAA2D,UAAAN,IAAI,EAAI;AACnEC,oBAAKoB,OAAL,CAAa;AAAEC,QAAAA,KAAK,EAAE;AAAE7B,UAAAA,KAAK,EAAEF,aAAa,CAACE;AAAvB;AAAT,OAAb,EAAwDU,IAAxD,CAA6D,UAAAuC,IAAI,EAAI;AAAA,YAC3DlB,EAD2D,GAChCkB,IADgC,CAC3DlB,EAD2D;AAAA,YACvDhC,IADuD,GAChCkD,IADgC,CACvDlD,IADuD;AAAA,YACjDC,KADiD,GAChCiD,IADgC,CACjDjD,KADiD;AAAA,YAC1CC,KAD0C,GAChCgD,IADgC,CAC1ChD,KAD0C;;AAEnE,YAAM+B,KAAK,GAAGC,sBAAIC,IAAJ,CACZ;AACEe,UAAAA,IAAI,EAAE;AAAElB,YAAAA,EAAE,EAAFA,EAAF;AAAMhC,YAAAA,IAAI,EAAJA,IAAN;AAAYC,YAAAA,KAAK,EAALA,KAAZ;AAAmBC,YAAAA,KAAK,EAALA;AAAnB;AADR,SADY,EAIZmC,YAJY,EAKZ;AACEC,UAAAA,SAAS,EAAE;AADb,SALY,CAAd;;AASA3C,sBACGoB,OADH,CACWC,YADX,EAEG8B,IAFH,mBAGGP,GAHH,CAGO,eAHP,mBAGkCN,KAHlC,GAIGc,IAJH,CAIQ;AACJC,UAAAA,MAAM,EAAEH,IAAI,CAACb;AADT,SAJR,EAOGrB,IAPH,CAOQ,UAAAO,GAAG,EAAI;AACXtB,UAAAA,MAAM,CAACsB,GAAD,CAAN,CAAYC,EAAZ,CAAeC,IAAf,CAAoBC,MAApB,CAA2B,GAA3B;AACA3B,UAAAA,MAAM,CAAC4B,KAAP,CAAaJ,GAAG,CAACK,IAAJ,CAASF,MAAtB,EAA8B,OAA9B;AACAb,UAAAA,IAAI;AACL,SAXH,EAYGgB,KAZH,CAYS,UAAAC,GAAG;AAAA,iBAAIC,OAAO,CAACC,GAAR,CAAY,cAAZ,EAA4BF,GAAG,CAACG,OAAhC,CAAJ;AAAA,SAZZ;AAaD,OAxBD;AAyBD,KA1BC,CAAF;AA2BAd,IAAAA,EAAE,kEAAkE,UAAAN,IAAI,EAAI;AAC1EC,oBAAKoB,OAAL,CAAa;AAAEC,QAAAA,KAAK,EAAE;AAAE7B,UAAAA,KAAK,EAAEG,aAAa,CAACH;AAAvB;AAAT,OAAb,EAAwDU,IAAxD,CAA6D,UAAAuC,IAAI,EAAI;AAAA,YAC3DlB,EAD2D,GAChCkB,IADgC,CAC3DlB,EAD2D;AAAA,YACvDhC,IADuD,GAChCkD,IADgC,CACvDlD,IADuD;AAAA,YACjDC,KADiD,GAChCiD,IADgC,CACjDjD,KADiD;AAAA,YAC1CC,KAD0C,GAChCgD,IADgC,CAC1ChD,KAD0C;;AAEnE,YAAM+B,KAAK,GAAGC,sBAAIC,IAAJ,CACZ;AACEe,UAAAA,IAAI,EAAE;AAAElB,YAAAA,EAAE,EAAFA,EAAF;AAAMhC,YAAAA,IAAI,EAAJA,IAAN;AAAYC,YAAAA,KAAK,EAALA,KAAZ;AAAmBC,YAAAA,KAAK,EAALA;AAAnB;AADR,SADY,EAIZmC,YAJY,EAKZ;AACEC,UAAAA,SAAS,EAAE;AADb,SALY,CAAd;;AASA3C,sBACGoB,OADH,CACWC,YADX,EAEG8B,IAFH,mBAGGP,GAHH,CAGO,eAHP,mBAGkCN,KAHlC,GAIGc,IAJH,CAIQ;AACJC,UAAAA,MAAM,EAAEH,IAAI,CAACb,EADT;AAEJiB,UAAAA,QAAQ,EAAE;AAFN,SAJR,EAQGtC,IARH,CAQQ,UAAAO,GAAG,EAAI;AACXtB,UAAAA,MAAM,CAACsB,GAAD,CAAN,CAAYC,EAAZ,CAAeC,IAAf,CAAoBC,MAApB,CAA2B,GAA3B;AACA3B,UAAAA,MAAM,CAAC4B,KAAP,CAAaJ,GAAG,CAACK,IAAJ,CAASF,MAAtB,EAA8B,SAA9B;AACAb,UAAAA,IAAI;AACL,SAZH,EAaGgB,KAbH,CAaS,UAAAC,GAAG;AAAA,iBAAIC,OAAO,CAACC,GAAR,CAAY,cAAZ,EAA4BF,GAAG,CAACG,OAAhC,CAAJ;AAAA,SAbZ;AAcD,OAzBD;AA0BD,KA3BC,CAAF;AA4BD,GAjFH,EAkFGJ,KAlFH,CAkFS,UAAAC,GAAG;AAAA,WAAIC,OAAO,CAACC,GAAR,CAAYF,GAAG,CAACG,OAAhB,CAAJ;AAAA,GAlFZ;AAmFD,CApFO,CAAR;AAsFAf,QAAQ,CAAC,kCAAD,EAAqC,YAAM;AACjDD,iBAAMF,MAAN,CAAaL,cAAb,EACGM,IADH,CACQ,UAAAoB,KAAK,EAAI;AACb,WAAOU,eAAK/B,MAAL,CAAY;AACjBV,MAAAA,IAAI,EAAE,YADW;AAEjB0C,MAAAA,KAAK,EAAE,GAFU;AAGjBO,MAAAA,QAAQ,EAAE,CAHO;AAIjBN,MAAAA,QAAQ,EAAE,QAJO;AAKjBC,MAAAA,OAAO,EAAEb,KAAK,CAACC;AALE,KAAZ,CAAP;AAOD,GATH,EAUGrB,IAVH,CAUQ,UAAAkC,IAAI,EAAI;AACZpC,kBAAKC,MAAL,CAAYyC,YAAZ,EACGxC,IADH,CACQ,UAAAuC,IAAI,EAAI;AACZ,aAAOE,oBAAU1C,MAAV,CAAiB;AAAEsC,QAAAA,MAAM,EAAEH,IAAI,CAACb,EAAf;AAAmBiB,QAAAA,QAAQ,EAAE,CAA7B;AAAgCI,QAAAA,MAAM,EAAEH,IAAI,CAAClB;AAA7C,OAAjB,CAAP;AACD,KAHH,EAIGrB,IAJH,CAIQ,UAAA2C,SAAS,EAAI;AACjBxC,MAAAA,EAAE,eAAQyC,UAAR,sDAAqE,UAAA/C,IAAI,EAAI;AAC7Eb,sBACGoB,OADH,CACWyC,GADX,EAEGC,GAFH,WAEUF,UAFV,qBAE+BD,SAAS,CAACtB,EAFzC,GAGGe,IAHH,CAGQ;AACJW,UAAAA,MAAM,EAAE;AADJ,SAHR,EAMG/C,IANH,CAMQ,UAAAO,GAAG,EAAI;AACXtB,UAAAA,MAAM,CAACsB,GAAD,CAAN,CAAYC,EAAZ,CAAeC,IAAf,CAAoBC,MAApB,CAA2B,GAA3B;AACA3B,UAAAA,MAAM,CAAC4B,KAAP,CAAaJ,GAAG,CAACK,IAAJ,CAASF,MAAtB,EAA8B,OAA9B;AACAb,UAAAA,IAAI;AACL,SAVH,EAWGgB,KAXH,CAWS,UAAAC,GAAG;AAAA,iBAAIC,OAAO,CAACC,GAAR,CAAY,sBAAZ,EAAoCF,GAAG,CAACG,OAAxC,CAAJ;AAAA,SAXZ;AAYD,OAbC,CAAF;AAcAd,MAAAA,EAAE,eAAQyC,UAAR,yDAAwE,UAAA/C,IAAI,EAAI;AAChFC,sBAAKoB,OAAL,CAAa;AAAEC,UAAAA,KAAK,EAAE;AAAE7B,YAAAA,KAAK,EAAEkD,YAAY,CAAClD;AAAtB;AAAT,SAAb,EAAuDU,IAAvD,CAA4D,UAAAuC,IAAI,EAAI;AAAA,cAC1DlB,EAD0D,GAC/BkB,IAD+B,CAC1DlB,EAD0D;AAAA,cACtDhC,IADsD,GAC/BkD,IAD+B,CACtDlD,IADsD;AAAA,cAChDC,KADgD,GAC/BiD,IAD+B,CAChDjD,KADgD;AAAA,cACzCC,KADyC,GAC/BgD,IAD+B,CACzChD,KADyC;;AAElE,cAAM+B,KAAK,GAAGC,sBAAIC,IAAJ,CACZ;AACEe,YAAAA,IAAI,EAAE;AAAElB,cAAAA,EAAE,EAAFA,EAAF;AAAMhC,cAAAA,IAAI,EAAJA,IAAN;AAAYC,cAAAA,KAAK,EAALA,KAAZ;AAAmBC,cAAAA,KAAK,EAALA;AAAnB;AADR,WADY,EAIZmC,YAJY,EAKZ;AACEC,YAAAA,SAAS,EAAE;AADb,WALY,CAAd;;AASA3C,wBACGoB,OADH,CACWyC,GADX,EAEGC,GAFH,WAEUF,UAFV,qBAE+BD,SAAS,CAACtB,EAFzC,GAGGO,GAHH,CAGO,eAHP,mBAGkCN,KAHlC,GAIGc,IAJH,CAIQ;AACJW,YAAAA,MAAM,EAAE;AADJ,WAJR,EAOG/C,IAPH,CAOQ,UAAAO,GAAG,EAAI;AACXtB,YAAAA,MAAM,CAACsB,GAAD,CAAN,CAAYC,EAAZ,CAAeC,IAAf,CAAoBC,MAApB,CAA2B,GAA3B;AACA3B,YAAAA,MAAM,CAAC4B,KAAP,CAAaJ,GAAG,CAACK,IAAJ,CAASF,MAAtB,EAA8B,OAA9B;AACAb,YAAAA,IAAI;AACL,WAXH,EAYGgB,KAZH,CAYS,UAAAC,GAAG;AAAA,mBAAIC,OAAO,CAACC,GAAR,CAAY,sBAAZ,EAAoCF,GAAG,CAACG,OAAxC,CAAJ;AAAA,WAZZ;AAaD,SAxBD;AAyBD,OA1BC,CAAF;AA2BAd,MAAAA,EAAE,eAAQyC,UAAR,0EAAyF,UAAA/C,IAAI,EAAI;AACjGC,sBAAKoB,OAAL,CAAa;AAAEC,UAAAA,KAAK,EAAE;AAAE7B,YAAAA,KAAK,EAAEkD,YAAY,CAAClD;AAAtB;AAAT,SAAb,EAAuDU,IAAvD,CAA4D,UAAAuC,IAAI,EAAI;AAAA,cAC1DlB,EAD0D,GAC/BkB,IAD+B,CAC1DlB,EAD0D;AAAA,cACtDhC,IADsD,GAC/BkD,IAD+B,CACtDlD,IADsD;AAAA,cAChDC,KADgD,GAC/BiD,IAD+B,CAChDjD,KADgD;AAAA,cACzCC,KADyC,GAC/BgD,IAD+B,CACzChD,KADyC;;AAElE,cAAM+B,KAAK,GAAGC,sBAAIC,IAAJ,CACZ;AACEe,YAAAA,IAAI,EAAE;AAAElB,cAAAA,EAAE,EAAFA,EAAF;AAAMhC,cAAAA,IAAI,EAAJA,IAAN;AAAYC,cAAAA,KAAK,EAALA,KAAZ;AAAmBC,cAAAA,KAAK,EAALA;AAAnB;AADR,WADY,EAIZmC,YAJY,EAKZ;AACEC,YAAAA,SAAS,EAAE;AADb,WALY,CAAd;;AASA3C,wBACGoB,OADH,CACWyC,GADX,EAEGC,GAFH,WAEUF,UAFV,qBAE+BD,SAAS,CAACtB,EAFzC,GAGGO,GAHH,CAGO,eAHP,mBAGkCN,KAHlC,GAIGc,IAJH,CAIQ;AACJW,YAAAA,MAAM,EAAE;AADJ,WAJR,EAOG/C,IAPH,CAOQ,UAAAO,GAAG,EAAI;AACXtB,YAAAA,MAAM,CAACsB,GAAD,CAAN,CAAYC,EAAZ,CAAeC,IAAf,CAAoBC,MAApB,CAA2B,GAA3B;AACA3B,YAAAA,MAAM,CAAC4B,KAAP,CAAaJ,GAAG,CAACK,IAAJ,CAASF,MAAtB,EAA8B,SAA9B;AACAb,YAAAA,IAAI;AACL,WAXH,EAYGgB,KAZH,CAYS,UAAAC,GAAG;AAAA,mBAAIC,OAAO,CAACC,GAAR,CAAY,sBAAZ,EAAoCF,GAAG,CAACG,OAAxC,CAAJ;AAAA,WAZZ;AAaD,SAxBD;AAyBD,OA1BC,CAAF;AA2BAd,MAAAA,EAAE,eAAQyC,UAAR,0EAAyF,UAAA/C,IAAI,EAAI;AACjGC,sBAAKoB,OAAL,CAAa;AAAEC,UAAAA,KAAK,EAAE;AAAE7B,YAAAA,KAAK,EAAEkD,YAAY,CAAClD;AAAtB;AAAT,SAAb,EAAuDU,IAAvD,CAA4D,UAAAuC,IAAI,EAAI;AAAA,cAC1DlB,EAD0D,GAC/BkB,IAD+B,CAC1DlB,EAD0D;AAAA,cACtDhC,IADsD,GAC/BkD,IAD+B,CACtDlD,IADsD;AAAA,cAChDC,KADgD,GAC/BiD,IAD+B,CAChDjD,KADgD;AAAA,cACzCC,KADyC,GAC/BgD,IAD+B,CACzChD,KADyC;;AAElE,cAAM+B,KAAK,GAAGC,sBAAIC,IAAJ,CACZ;AACEe,YAAAA,IAAI,EAAE;AAAElB,cAAAA,EAAE,EAAFA,EAAF;AAAMhC,cAAAA,IAAI,EAAJA,IAAN;AAAYC,cAAAA,KAAK,EAALA,KAAZ;AAAmBC,cAAAA,KAAK,EAALA;AAAnB;AADR,WADY,EAIZmC,YAJY,EAKZ;AACEC,YAAAA,SAAS,EAAE;AADb,WALY,CAAd;;AASA3C,wBACGoB,OADH,CACWyC,GADX,EAEGC,GAFH,WAEUF,UAFV,qBAE+BD,SAAS,CAACtB,EAFzC,GAGGO,GAHH,CAGO,eAHP,mBAGkCN,KAHlC,GAIGc,IAJH,CAIQ;AACJW,YAAAA,MAAM,EAAE;AADJ,WAJR,EAOG/C,IAPH,CAOQ,UAAAO,GAAG,EAAI;AACXtB,YAAAA,MAAM,CAACsB,GAAD,CAAN,CAAYC,EAAZ,CAAeC,IAAf,CAAoBC,MAApB,CAA2B,GAA3B;AACA3B,YAAAA,MAAM,CAAC4B,KAAP,CAAaJ,GAAG,CAACK,IAAJ,CAASF,MAAtB,EAA8B,SAA9B;AACAb,YAAAA,IAAI;AACL,WAXH,EAYGgB,KAZH,CAYS,UAAAC,GAAG;AAAA,mBAAIC,OAAO,CAACC,GAAR,CAAY,sBAAZ,EAAoCF,GAAG,CAACG,OAAxC,CAAJ;AAAA,WAZZ;AAaD,SAxBD;AAyBD,OA1BC,CAAF;AA2BAd,MAAAA,EAAE,eAAQyC,UAAR,+DAA8E,UAAA/C,IAAI,EAAI;AACtFC,sBAAKoB,OAAL,CAAa;AAAEC,UAAAA,KAAK,EAAE;AAAE7B,YAAAA,KAAK,EAAEkD,YAAY,CAAClD;AAAtB;AAAT,SAAb,EAAuDU,IAAvD,CAA4D,UAAAuC,IAAI,EAAI;AAAA,cAC1DlB,EAD0D,GAC/BkB,IAD+B,CAC1DlB,EAD0D;AAAA,cACtDhC,IADsD,GAC/BkD,IAD+B,CACtDlD,IADsD;AAAA,cAChDC,KADgD,GAC/BiD,IAD+B,CAChDjD,KADgD;AAAA,cACzCC,KADyC,GAC/BgD,IAD+B,CACzChD,KADyC;;AAElE,cAAM+B,KAAK,GAAGC,sBAAIC,IAAJ,CACZ;AACEe,YAAAA,IAAI,EAAE;AAAElB,cAAAA,EAAE,EAAFA,EAAF;AAAMhC,cAAAA,IAAI,EAAJA,IAAN;AAAYC,cAAAA,KAAK,EAALA,KAAZ;AAAmBC,cAAAA,KAAK,EAALA;AAAnB;AADR,WADY,EAIZmC,YAJY,EAKZ;AACEC,YAAAA,SAAS,EAAE;AADb,WALY,CAAd;;AASA3C,wBACGoB,OADH,CACWyC,GADX,EAEGC,GAFH,WAEUF,UAFV,qBAE+BD,SAAS,CAACtB,EAFzC,GAGGO,GAHH,CAGO,eAHP,mBAGkCN,KAHlC,GAIGc,IAJH,CAIQ;AACJW,YAAAA,MAAM,EAAE;AADJ,WAJR,EAOG/C,IAPH,CAOQ,UAAAO,GAAG,EAAI;AACXtB,YAAAA,MAAM,CAACsB,GAAD,CAAN,CAAYC,EAAZ,CAAeC,IAAf,CAAoBC,MAApB,CAA2B,GAA3B;AACA3B,YAAAA,MAAM,CAAC4B,KAAP,CAAaJ,GAAG,CAACK,IAAJ,CAASF,MAAtB,EAA8B,SAA9B;AACAb,YAAAA,IAAI;AACL,WAXH,EAYGgB,KAZH,CAYS,UAAAC,GAAG;AAAA,mBAAIC,OAAO,CAACC,GAAR,CAAY,sBAAZ,EAAoCF,GAAG,CAACG,OAAxC,CAAJ;AAAA,WAZZ;AAaD,SAxBD;AAyBD,OA1BC,CAAF;AA2BD,KA/HH;AAgID,GA3IH,EA4IGJ,KA5IH,CA4IS,UAAAC,GAAG;AAAA,WAAIC,OAAO,CAACC,GAAR,CAAYF,GAAG,CAACG,OAAhB,CAAJ;AAAA,GA5IZ;AA6ID,CA9IO,CAAR;AAgJAf,QAAQ,CAAC,oCAAD,EAAuC,YAAM;AACnDD,iBAAMF,MAAN,CAAaJ,cAAb,EACGK,IADH,CACQ,UAAAoB,KAAK,EAAI;AACb,WAAOU,eAAK/B,MAAL,CAAY;AACjBV,MAAAA,IAAI,EAAE,SADW;AAEjB0C,MAAAA,KAAK,EAAE,IAFU;AAGjBO,MAAAA,QAAQ,EAAE,OAHO;AAIjBN,MAAAA,QAAQ,EAAE,aAJO;AAKjBC,MAAAA,OAAO,EAAEb,KAAK,CAACC;AALE,KAAZ,CAAP;AAOD,GATH,EAUGrB,IAVH,CAUQ,UAAAkC,IAAI,EAAI;AACZpC,kBAAKC,MAAL,CAAYX,aAAZ,EACGY,IADH,CACQ,UAAAuC,IAAI,EAAI;AACZ,aAAOE,oBAAU1C,MAAV,CAAiB;AAAEsC,QAAAA,MAAM,EAAEH,IAAI,CAACb,EAAf;AAAmBiB,QAAAA,QAAQ,EAAE,QAA7B;AAAuCI,QAAAA,MAAM,EAAEH,IAAI,CAAClB;AAApD,OAAjB,CAAP;AACD,KAHH,EAIGrB,IAJH,CAIQ,YAAM;AACVG,MAAAA,EAAE,+DAA+D,UAAAN,IAAI,EAAI;AACvEb,sBACGoB,OADH,CACWC,YADX,EAEGC,GAFH,wBAGGN,IAHH,CAGQ,UAAAO,GAAG,EAAI;AACXtB,UAAAA,MAAM,CAACsB,GAAD,CAAN,CAAYC,EAAZ,CAAeC,IAAf,CAAoBC,MAApB,CAA2B,GAA3B;AACA3B,UAAAA,MAAM,CAAC4B,KAAP,CAAaJ,GAAG,CAACK,IAAJ,CAASF,MAAtB,EAA8B,OAA9B;AACAb,UAAAA,IAAI;AACL,SAPH,EAQGgB,KARH,CAQS,UAAAC,GAAG;AAAA,iBAAIC,OAAO,CAACC,GAAR,CAAY,kBAAZ,EAAgCF,GAAG,CAACG,OAApC,CAAJ;AAAA,SARZ;AASD,OAVC,CAAF;AAWAd,MAAAA,EAAE,oEAAoE,UAAAN,IAAI,EAAI;AAC5EC,sBAAKoB,OAAL,CAAa;AAAEC,UAAAA,KAAK,EAAE;AAAE7B,YAAAA,KAAK,EAAEF,aAAa,CAACE;AAAvB;AAAT,SAAb,EAAwDU,IAAxD,CAA6D,UAAAuC,IAAI,EAAI;AAAA,cAC3DlB,EAD2D,GAChCkB,IADgC,CAC3DlB,EAD2D;AAAA,cACvDhC,IADuD,GAChCkD,IADgC,CACvDlD,IADuD;AAAA,cACjDC,KADiD,GAChCiD,IADgC,CACjDjD,KADiD;AAAA,cAC1CC,KAD0C,GAChCgD,IADgC,CAC1ChD,KAD0C;;AAEnE,cAAM+B,KAAK,GAAGC,sBAAIC,IAAJ,CACZ;AACEe,YAAAA,IAAI,EAAE;AAAElB,cAAAA,EAAE,EAAFA,EAAF;AAAMhC,cAAAA,IAAI,EAAJA,IAAN;AAAYC,cAAAA,KAAK,EAALA,KAAZ;AAAmBC,cAAAA,KAAK,EAALA;AAAnB;AADR,WADY,EAIZmC,YAJY,EAKZ;AACEC,YAAAA,SAAS,EAAE;AADb,WALY,CAAd;;AASA3C,wBACGoB,OADH,CACWC,YADX,EAEGC,GAFH,wBAGGsB,GAHH,CAGO,eAHP,mBAGkCN,KAHlC,GAIGtB,IAJH,CAIQ,UAAAO,GAAG,EAAI;AACXtB,YAAAA,MAAM,CAACsB,GAAD,CAAN,CAAYC,EAAZ,CAAeC,IAAf,CAAoBC,MAApB,CAA2B,GAA3B;AACA3B,YAAAA,MAAM,CAAC4B,KAAP,CAAaJ,GAAG,CAACK,IAAJ,CAASF,MAAtB,EAA8B,SAA9B;AACAb,YAAAA,IAAI;AACL,WARH,EASGgB,KATH,CASS,UAAAC,GAAG;AAAA,mBAAIC,OAAO,CAACC,GAAR,CAAY,kBAAZ,EAAgCF,GAAG,CAACG,OAApC,CAAJ;AAAA,WATZ;AAUD,SArBD;AAsBD,OAvBC,CAAF;AAwBD,KAxCH;AAyCD,GApDH;AAqDD,CAtDO,CAAR;AAwDAf,QAAQ,CAAC,oCAAD,EAAuC,YAAM;AACnDD,iBAAMF,MAAN,CAAaL,cAAb,EACGM,IADH,CACQ,UAAAoB,KAAK,EAAI;AACb,WAAOU,eAAK/B,MAAL,CAAY;AACjBV,MAAAA,IAAI,EAAE,YADW;AAEjB0C,MAAAA,KAAK,EAAE,IAFU;AAGjBO,MAAAA,QAAQ,EAAE,OAHO;AAIjBN,MAAAA,QAAQ,EAAE,UAJO;AAKjBC,MAAAA,OAAO,EAAEb,KAAK,CAACC;AALE,KAAZ,CAAP;AAOD,GATH,EAUGrB,IAVH,CAUQ,UAAAkC,IAAI,EAAI;AACZ,QAAMc,OAAO,GAAG,EAAhB;AACAA,IAAAA,OAAO,CAACC,IAAR,CAAa;AACX5B,MAAAA,EAAE,EAAEa,IAAI,CAACb,EADE;AAEXhC,MAAAA,IAAI,EAAE6C,IAAI,CAAC7C,IAFA;AAGX0C,MAAAA,KAAK,EAAEG,IAAI,CAACH,KAHD;AAIXO,MAAAA,QAAQ,EAAEJ,IAAI,CAACI,QAJJ;AAKXN,MAAAA,QAAQ,EAAEE,IAAI,CAACF,QALJ;AAMXC,MAAAA,OAAO,EAAEC,IAAI,CAACD;AANH,KAAb;AAQA,WAAOiB,cAAKnD,MAAL,CAAY;AAAEoD,MAAAA,KAAK,EAAEC,IAAI,CAACC,SAAL,CAAeL,OAAf,CAAT;AAAkCf,MAAAA,OAAO,EAAEC,IAAI,CAACD;AAAhD,KAAZ,CAAP;AACD,GArBH,EAsBGjC,IAtBH,CAsBQ,UAAAsD,IAAI,EAAI;AACZxD,kBAAKC,MAAL,CAAYX,aAAZ,EACGY,IADH,CACQ,UAAAuC,IAAI,EAAI;AACZ,UAAMY,KAAK,GAAGC,IAAI,CAACG,KAAL,CAAWD,IAAI,CAACH,KAAhB,CAAd;AACA,aAAOV,oBAAU1C,MAAV,CAAiB;AAAEsC,QAAAA,MAAM,EAAEc,KAAK,CAAC,CAAD,CAAL,CAAS9B,EAAnB;AAAuBiB,QAAAA,QAAQ,EAAE,OAAjC;AAA0CI,QAAAA,MAAM,EAAEH,IAAI,CAAClB;AAAvD,OAAjB,CAAP;AACD,KAJH,EAKGrB,IALH,CAKQ,YAAM;AACVG,MAAAA,EAAE,iEAAiE,UAAAN,IAAI,EAAI;AACzEb,sBACGoB,OADH,CACWC,YADX,EAEG8B,IAFH,4BAGGC,IAHH,CAGQ;AACJoB,UAAAA,gBAAgB,EAAE;AADd,SAHR,EAMGxD,IANH,CAMQ,UAAAO,GAAG,EAAI;AACXtB,UAAAA,MAAM,CAACsB,GAAD,CAAN,CAAYC,EAAZ,CAAeC,IAAf,CAAoBC,MAApB,CAA2B,GAA3B;AACA3B,UAAAA,MAAM,CAAC4B,KAAP,CAAaJ,GAAG,CAACK,IAAJ,CAASF,MAAtB,EAA8B,OAA9B;AACAb,UAAAA,IAAI;AACL,SAVH,EAWGgB,KAXH,CAWS,UAAAC,GAAG;AAAA,iBAAIC,OAAO,CAACC,GAAR,CAAY,uBAAZ,EAAqCF,GAAG,CAACG,OAAzC,CAAJ;AAAA,SAXZ;AAYD,OAbC,CAAF;AAcAd,MAAAA,EAAE,oEAAoE,UAAAN,IAAI,EAAI;AAC5EC,sBAAKoB,OAAL,CAAa;AAAEC,UAAAA,KAAK,EAAE;AAAE7B,YAAAA,KAAK,EAAEF,aAAa,CAACE;AAAvB;AAAT,SAAb,EAAwDU,IAAxD,CAA6D,UAAAuC,IAAI,EAAI;AAAA,cAC3DlB,EAD2D,GAChCkB,IADgC,CAC3DlB,EAD2D;AAAA,cACvDhC,IADuD,GAChCkD,IADgC,CACvDlD,IADuD;AAAA,cACjDC,KADiD,GAChCiD,IADgC,CACjDjD,KADiD;AAAA,cAC1CC,KAD0C,GAChCgD,IADgC,CAC1ChD,KAD0C;;AAEnE,cAAM+B,KAAK,GAAGC,sBAAIC,IAAJ,CACZ;AACEe,YAAAA,IAAI,EAAE;AAAElB,cAAAA,EAAE,EAAFA,EAAF;AAAMhC,cAAAA,IAAI,EAAJA,IAAN;AAAYC,cAAAA,KAAK,EAALA,KAAZ;AAAmBC,cAAAA,KAAK,EAALA;AAAnB;AADR,WADY,EAIZmC,YAJY,EAKZ;AACEC,YAAAA,SAAS,EAAE;AADb,WALY,CAAd;;AASA3C,wBACGoB,OADH,CACWC,YADX,EAEG8B,IAFH,4BAGGP,GAHH,CAGO,eAHP,mBAGkCN,KAHlC,GAIGc,IAJH,CAIQ;AACJoB,YAAAA,gBAAgB,EAAE;AADd,WAJR,EAOGxD,IAPH,CAOQ,UAAAO,GAAG,EAAI;AACXtB,YAAAA,MAAM,CAACsB,GAAD,CAAN,CAAYC,EAAZ,CAAeC,IAAf,CAAoBC,MAApB,CAA2B,GAA3B;AACA3B,YAAAA,MAAM,CAAC4B,KAAP,CAAaJ,GAAG,CAACK,IAAJ,CAASF,MAAtB,EAA8B,OAA9B;AACAb,YAAAA,IAAI;AACL,WAXH,EAYGgB,KAZH,CAYS,UAAAC,GAAG;AAAA,mBAAIC,OAAO,CAACC,GAAR,CAAY,uBAAZ,EAAqCF,GAAG,CAACG,OAAzC,CAAJ;AAAA,WAZZ;AAaD,SAxBD;AAyBD,OA1BC,CAAF;AA2BAd,MAAAA,EAAE,sEAAsE,UAAAN,IAAI,EAAI;AAC9EC,sBAAKoB,OAAL,CAAa;AAAEC,UAAAA,KAAK,EAAE;AAAE7B,YAAAA,KAAK,EAAEG,aAAa,CAACH;AAAvB;AAAT,SAAb,EAAwDU,IAAxD,CAA6D,UAAAuC,IAAI,EAAI;AAAA,cAC3DlB,EAD2D,GAChCkB,IADgC,CAC3DlB,EAD2D;AAAA,cACvDhC,IADuD,GAChCkD,IADgC,CACvDlD,IADuD;AAAA,cACjDC,KADiD,GAChCiD,IADgC,CACjDjD,KADiD;AAAA,cAC1CC,KAD0C,GAChCgD,IADgC,CAC1ChD,KAD0C;;AAEnE,cAAM+B,KAAK,GAAGC,sBAAIC,IAAJ,CACZ;AACEe,YAAAA,IAAI,EAAE;AAAElB,cAAAA,EAAE,EAAFA,EAAF;AAAMhC,cAAAA,IAAI,EAAJA,IAAN;AAAYC,cAAAA,KAAK,EAALA,KAAZ;AAAmBC,cAAAA,KAAK,EAALA;AAAnB;AADR,WADY,EAIZmC,YAJY,EAKZ;AACEC,YAAAA,SAAS,EAAE;AADb,WALY,CAAd;;AASA3C,wBACGoB,OADH,CACWC,YADX,EAEG8B,IAFH,4BAGGP,GAHH,CAGO,eAHP,mBAGkCN,KAHlC,GAIGc,IAJH,CAIQ;AACJoB,YAAAA,gBAAgB,EAAE;AADd,WAJR,EAOGxD,IAPH,CAOQ,UAAAO,GAAG,EAAI;AACXtB,YAAAA,MAAM,CAACsB,GAAD,CAAN,CAAYC,EAAZ,CAAeC,IAAf,CAAoBC,MAApB,CAA2B,GAA3B;AACA3B,YAAAA,MAAM,CAAC4B,KAAP,CAAaJ,GAAG,CAACK,IAAJ,CAASF,MAAtB,EAA8B,SAA9B;AACAb,YAAAA,IAAI;AACL,WAXH,EAYGgB,KAZH,CAYS,UAAAC,GAAG;AAAA,mBAAIC,OAAO,CAACC,GAAR,CAAY,uBAAZ,EAAqCF,GAAG,CAACG,OAAzC,CAAJ;AAAA,WAZZ;AAaD,SAxBD;AAyBD,OA1BC,CAAF;AA2BD,KA1EH;AA2ED,GAlGH,EAmGGJ,KAnGH,CAmGS,UAAAC,GAAG;AAAA,WAAIC,OAAO,CAACC,GAAR,CAAYF,GAAG,CAACG,OAAhB,CAAJ;AAAA,GAnGZ;AAoGD,CArGO,CAAR;AAuGAwC,KAAK,CAAC,UAAA5D,IAAI,EAAI;AACZC,gBAAK4D,OAAL,CAAa;AAAEvC,IAAAA,KAAK,EAAE;AAAE7B,MAAAA,KAAK,EAAEF,aAAa,CAACE;AAAvB;AAAT,GAAb,EACGU,IADH;AAAA;AAAA;AAAA;AAAA,0BACQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACEC,eAAMyD,OAAN,CAAc;AAAEvC,cAAAA,KAAK,EAAE;AAAE7B,gBAAAA,KAAK,EAAEI,cAAc,CAACJ;AAAxB;AAAT,aAAd,CADF;;AAAA;AAAA;AAAA,mBAEEW,eAAMyD,OAAN,CAAc;AAAEvC,cAAAA,KAAK,EAAE;AAAE7B,gBAAAA,KAAK,EAAEK,cAAc,CAACL;AAAxB;AAAT,aAAd,CAFF;;AAAA;AAAA;AAAA,mBAGEQ,cAAK4D,OAAL,CAAa;AAAEvC,cAAAA,KAAK,EAAE;AAAE7B,gBAAAA,KAAK,EAAEG,aAAa,CAACH;AAAvB;AAAT,aAAb,CAHF;;AAAA;AAAA;AAAA,mBAIEQ,cAAK4D,OAAL,CAAa;AAAEvC,cAAAA,KAAK,EAAE;AAAE7B,gBAAAA,KAAK,EAAEF,aAAa,CAACE;AAAvB;AAAT,aAAb,CAJF;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GADR,IAOGU,IAPH,CAOQ,YAAM;AACVH,IAAAA,IAAI;AACL,GATH;AAUD,CAXI,CAAL","sourcesContent":["process.env.NODE_ENV = 'test';\r\nimport fs from 'fs';\r\nimport path from 'path';\r\nimport chai from 'chai';\r\nimport chaiHttp from 'chai-http';\r\nimport server from '../src/app';\r\nimport jwt from 'jsonwebtoken';\r\nimport secret from '../src/util/jwt';\r\nimport User from '../src/models/user';\r\nimport Admin from '../src/models/admin';\r\nimport Menu from '../src/models/menu';\r\nimport Meal from '../src/models/meals';\r\nimport OrderItem from '../src/models/orderItems';\r\nconst { assert, expect } = chai;\r\nchai.use(chaiHttp);\r\n\r\nconst user0_Payload = {\r\n  name: 'Wale Cliff',\r\n  email: 'wale@ymail.com',\r\n  phone: '07090909080',\r\n  password: 'wale123456'\r\n};\r\n\r\nconst user1_Payload = {\r\n  name: 'Ola David',\r\n  email: 'ola@ymail.com',\r\n  phone: '07090909080',\r\n  password: 'david123456'\r\n};\r\n\r\nconst admin0_Payload = {\r\n  name: 'admin admin',\r\n  phone: '07060538862',\r\n  email: 'admin@gmail.com',\r\n  password: 'admin123456'\r\n};\r\n\r\nconst admin1_Payload = {\r\n  name: 'admin1 admin1',\r\n  phone: '09057996214',\r\n  email: 'admin1@gmail.com',\r\n  password: 'admin123456'\r\n};\r\n\r\nbefore(done => {\r\n  User.create(user0_Payload)\r\n    .then(() => {\r\n      return Admin.create(admin0_Payload);\r\n    })\r\n    .then(() => {\r\n      done();\r\n    });\r\n});\r\n\r\ndescribe('Admin Get all Orders Endpoint ', () => {\r\n  it(`GET /api/v1/orders - Fetch All Orders (Unauthorized)`, done => {\r\n    chai\r\n      .request(server)\r\n      .get(`/api/v1/orders`)\r\n      .then(res => {\r\n        expect(res).to.have.status(401);\r\n        assert.equal(res.body.status, 'error');\r\n        done();\r\n      })\r\n      .catch(err => console.log('GET /orders', err.message));\r\n  });\r\n  it(`GET /apii/v1/orders - Fetch All Orders - Authorized`, done => {\r\n    Admin.findOne({ where: { email: admin0_Payload.email } })\r\n      .then(admin => {\r\n        const { id, name, email, phone } = admin;\r\n        const token = jwt.sign(\r\n          {\r\n            admin: { id, name, email, phone },\r\n            isAdmin: true\r\n          },\r\n          secret,\r\n          {\r\n            expiresIn: '2h'\r\n          }\r\n        );\r\n        chai\r\n          .request(server)\r\n          .get(`api/v1/orders`)\r\n          .set('Authorization', `Bearer ${token}`)\r\n          .then(res => {\r\n            expect(res).to.have.status(200);\r\n            assert.equal(res.body.status, 'success');\r\n            done();\r\n          })\r\n          .catch(err => console.log('GET /orders', err.message));\r\n      })\r\n      .catch(err => console.log(err.errors[0].name));\r\n  });\r\n});\r\n\r\ndescribe('User can add to Orders Endpoint ', () => {\r\n  Admin.create(admin0_Payload)\r\n    .then(admin => {\r\n      return Meal.create({\r\n        name: 'fried Meat',\r\n        price: 1500,\r\n        imageUrl: 'meat.png',\r\n        adminId: admin.id\r\n      });\r\n    })\r\n    .then(meal => {\r\n      it(`POST /api/v1/orders - Add To Orders (Unauthorized)`, done => {\r\n        chai\r\n          .request(server)\r\n          .post(`/api/v1/orders`)\r\n          .send({\r\n            mealId: meal.id,\r\n            quantity: 1\r\n          })\r\n          .then(res => {\r\n            expect(res).to.have.status(401);\r\n            assert.equal(res.body.status, 'error');\r\n            done();\r\n          })\r\n          .catch(err => console.log('POST /orders', err.message));\r\n      });\r\n\r\n      it(`POST /api/v1/orders - Add To Orders == Validation Test`, done => {\r\n        User.findOne({ where: { email: user0_Payload.email } }).then(user => {\r\n          const { id, name, email, phone } = user;\r\n          const token = jwt.sign(\r\n            {\r\n              user: { id, name, email, phone }\r\n            },\r\n            secret,\r\n            {\r\n              expiresIn: '1h'\r\n            }\r\n          );\r\n          chai\r\n            .request(server)\r\n            .post(`/api/v1/orders`)\r\n            .set('Authorization', `Bearer ${token}`)\r\n            .send({\r\n              mealId: meal.id\r\n            })\r\n            .then(res => {\r\n              expect(res).to.have.status(400);\r\n              assert.equal(res.body.status, 'error');\r\n              done();\r\n            })\r\n            .catch(err => console.log('POST /orders', err.message));\r\n        });\r\n      });\r\n      it(`POST /api/v1/orders - Add To Orders - (User can Add to Order)`, done => {\r\n        User.findOne({ where: { email: user1_Payload.email } }).then(user => {\r\n          const { id, name, email, phone } = user;\r\n          const token = jwt.sign(\r\n            {\r\n              user: { id, name, email, phone }\r\n            },\r\n            secret,\r\n            {\r\n              expiresIn: '2h'\r\n            }\r\n          );\r\n          chai\r\n            .request(server)\r\n            .post(`/api/v1/orders`)\r\n            .set('Authorization', `Bearer ${token}`)\r\n            .send({\r\n              mealId: meal.id,\r\n              quantity: 'small'\r\n            })\r\n            .then(res => {\r\n              expect(res).to.have.status(200);\r\n              assert.equal(res.body.status, 'success');\r\n              done();\r\n            })\r\n            .catch(err => console.log('POST /orders', err.message));\r\n        });\r\n      });\r\n    })\r\n    .catch(err => console.log(err.message));\r\n});\r\n\r\ndescribe('User can Modify Orders Endpoints', () => {\r\n  Admin.create(admin0_Payload)\r\n    .then(admin => {\r\n      return Meal.create({\r\n        name: 'Dummy Meal',\r\n        price: 500,\r\n        quantity: 4,\r\n        imageUrl: 'fk.png',\r\n        adminId: admin.id\r\n      });\r\n    })\r\n    .then(meal => {\r\n      User.create(user2Payload)\r\n        .then(user => {\r\n          return OrderItem.create({ mealId: meal.id, quantity: 3, userId: user.id });\r\n        })\r\n        .then(orderItem => {\r\n          it(`PUT ${API_PREFIX}/orders/:orderId - Modify Orders (Unauthorized)`, done => {\r\n            chai\r\n              .request(app)\r\n              .put(`${API_PREFIX}/orders/${orderItem.id}`)\r\n              .send({\r\n                action: 'increase'\r\n              })\r\n              .then(res => {\r\n                expect(res).to.have.status(401);\r\n                assert.equal(res.body.status, 'error');\r\n                done();\r\n              })\r\n              .catch(err => console.log('PUT /orders/:orderId', err.message));\r\n          });\r\n          it(`PUT ${API_PREFIX}/orders/:orderId - Modify Orders (Validation Test)`, done => {\r\n            User.findOne({ where: { email: user2Payload.email } }).then(user => {\r\n              const { id, name, email, phone } = user;\r\n              const token = jwt.sign(\r\n                {\r\n                  user: { id, name, email, phone }\r\n                },\r\n                secret,\r\n                {\r\n                  expiresIn: 86400\r\n                }\r\n              );\r\n              chai\r\n                .request(app)\r\n                .put(`${API_PREFIX}/orders/${orderItem.id}`)\r\n                .set('Authorization', `Bearer ${token}`)\r\n                .send({\r\n                  action: 'something'\r\n                })\r\n                .then(res => {\r\n                  expect(res).to.have.status(400);\r\n                  assert.equal(res.body.status, 'error');\r\n                  done();\r\n                })\r\n                .catch(err => console.log('PUT /orders/:orderId', err.message));\r\n            });\r\n          });\r\n          it(`PUT ${API_PREFIX}/orders/:orderId - Modify Orders (User Can Increase Order Quantity)`, done => {\r\n            User.findOne({ where: { email: user2Payload.email } }).then(user => {\r\n              const { id, name, email, phone } = user;\r\n              const token = jwt.sign(\r\n                {\r\n                  user: { id, name, email, phone }\r\n                },\r\n                secret,\r\n                {\r\n                  expiresIn: 86400\r\n                }\r\n              );\r\n              chai\r\n                .request(app)\r\n                .put(`${API_PREFIX}/orders/${orderItem.id}`)\r\n                .set('Authorization', `Bearer ${token}`)\r\n                .send({\r\n                  action: 'increase'\r\n                })\r\n                .then(res => {\r\n                  expect(res).to.have.status(200);\r\n                  assert.equal(res.body.status, 'success');\r\n                  done();\r\n                })\r\n                .catch(err => console.log('PUT /orders/:orderId', err.message));\r\n            });\r\n          });\r\n          it(`PUT ${API_PREFIX}/orders/:orderId - Modify Orders (User Can Decrease Order Quantity)`, done => {\r\n            User.findOne({ where: { email: user2Payload.email } }).then(user => {\r\n              const { id, name, email, phone } = user;\r\n              const token = jwt.sign(\r\n                {\r\n                  user: { id, name, email, phone }\r\n                },\r\n                secret,\r\n                {\r\n                  expiresIn: 86400\r\n                }\r\n              );\r\n              chai\r\n                .request(app)\r\n                .put(`${API_PREFIX}/orders/${orderItem.id}`)\r\n                .set('Authorization', `Bearer ${token}`)\r\n                .send({\r\n                  action: 'decrease'\r\n                })\r\n                .then(res => {\r\n                  expect(res).to.have.status(200);\r\n                  assert.equal(res.body.status, 'success');\r\n                  done();\r\n                })\r\n                .catch(err => console.log('PUT /orders/:orderId', err.message));\r\n            });\r\n          });\r\n          it(`PUT ${API_PREFIX}/orders/:orderId - Modify Orders (User Can Delete Order)`, done => {\r\n            User.findOne({ where: { email: user2Payload.email } }).then(user => {\r\n              const { id, name, email, phone } = user;\r\n              const token = jwt.sign(\r\n                {\r\n                  user: { id, name, email, phone }\r\n                },\r\n                secret,\r\n                {\r\n                  expiresIn: 86400\r\n                }\r\n              );\r\n              chai\r\n                .request(app)\r\n                .put(`${API_PREFIX}/orders/${orderItem.id}`)\r\n                .set('Authorization', `Bearer ${token}`)\r\n                .send({\r\n                  action: 'delete'\r\n                })\r\n                .then(res => {\r\n                  expect(res).to.have.status(200);\r\n                  assert.equal(res.body.status, 'success');\r\n                  done();\r\n                })\r\n                .catch(err => console.log('PUT /orders/:orderId', err.message));\r\n            });\r\n          });\r\n        });\r\n    })\r\n    .catch(err => console.log(err.message));\r\n});\r\n\r\ndescribe('Admin Can Get their Menu Endpoint ', () => {\r\n  Admin.create(admin1_Payload)\r\n    .then(admin => {\r\n      return Meal.create({\r\n        name: 'shawama',\r\n        price: 2000,\r\n        quantity: 'large',\r\n        imageUrl: 'shawama.png',\r\n        adminId: admin.id\r\n      });\r\n    })\r\n    .then(meal => {\r\n      User.create(user0_Payload)\r\n        .then(user => {\r\n          return OrderItem.create({ mealId: meal.id, quantity: 'medium', userId: user.id });\r\n        })\r\n        .then(() => {\r\n          it(`GET /api/v1/orders/user - Fetch Order Items (Unauthorized)`, done => {\r\n            chai\r\n              .request(server)\r\n              .get(`/api/v1/orders/user`)\r\n              .then(res => {\r\n                expect(res).to.have.status(401);\r\n                assert.equal(res.body.status, 'error');\r\n                done();\r\n              })\r\n              .catch(err => console.log('GET /orders/user', err.message));\r\n          });\r\n          it(`GET /api/v1/orders/user - Fetch Order Items - (User Authorized)`, done => {\r\n            User.findOne({ where: { email: user0_Payload.email } }).then(user => {\r\n              const { id, name, email, phone } = user;\r\n              const token = jwt.sign(\r\n                {\r\n                  user: { id, name, email, phone }\r\n                },\r\n                secret,\r\n                {\r\n                  expiresIn: '1h'\r\n                }\r\n              );\r\n              chai\r\n                .request(server)\r\n                .get(`/api/v1/orders/user`)\r\n                .set('Authorization', `Bearer ${token}`)\r\n                .then(res => {\r\n                  expect(res).to.have.status(200);\r\n                  assert.equal(res.body.status, 'success');\r\n                  done();\r\n                })\r\n                .catch(err => console.log('GET /orders/user', err.message));\r\n            });\r\n          });\r\n        });\r\n    });\r\n});\r\n\r\ndescribe('User can Checkout Orders Endpoint ', () => {\r\n  Admin.create(admin0_Payload)\r\n    .then(admin => {\r\n      return Meal.create({\r\n        name: 'fried rice',\r\n        price: 2000,\r\n        quantity: 'large',\r\n        imageUrl: 'rice.png',\r\n        adminId: admin.id\r\n      });\r\n    })\r\n    .then(meal => {\r\n      const newMenu = [];\r\n      newMenu.push({\r\n        id: meal.id,\r\n        name: meal.name,\r\n        price: meal.price,\r\n        quantity: meal.quantity,\r\n        imageUrl: meal.imageUrl,\r\n        adminId: meal.adminId\r\n      });\r\n      return Menu.create({ meals: JSON.stringify(newMenu), adminId: meal.adminId });\r\n    })\r\n    .then(menu => {\r\n      User.create(user0_Payload)\r\n        .then(user => {\r\n          const meals = JSON.parse(menu.meals);\r\n          return OrderItem.create({ mealId: meals[0].id, quantity: 'small', userId: user.id });\r\n        })\r\n        .then(() => {\r\n          it(`POST /api/v1/orders/checkout - Order Checkout (Unauthorized)`, done => {\r\n            chai\r\n              .request(server)\r\n              .post(`/api/v1/orders/checkout`)\r\n              .send({\r\n                delivery_address: 'festac lagos'\r\n              })\r\n              .then(res => {\r\n                expect(res).to.have.status(401);\r\n                assert.equal(res.body.status, 'error');\r\n                done();\r\n              })\r\n              .catch(err => console.log('POST /orders/checkout', err.message));\r\n          });\r\n          it(`POST /api/v1/orders/checkout - Order Checkout (Validation Test)`, done => {\r\n            User.findOne({ where: { email: user0_Payload.email } }).then(user => {\r\n              const { id, name, email, phone } = user;\r\n              const token = jwt.sign(\r\n                {\r\n                  user: { id, name, email, phone }\r\n                },\r\n                secret,\r\n                {\r\n                  expiresIn: '1h'\r\n                }\r\n              );\r\n              chai\r\n                .request(server)\r\n                .post(`/api/v1/orders/checkout`)\r\n                .set('Authorization', `Bearer ${token}`)\r\n                .send({\r\n                  delivery_address: 'satellite lagos'\r\n                })\r\n                .then(res => {\r\n                  expect(res).to.have.status(400);\r\n                  assert.equal(res.body.status, 'error');\r\n                  done();\r\n                })\r\n                .catch(err => console.log('POST /orders/checkout', err.message));\r\n            });\r\n          });\r\n          it(`POST /api/v1/orders/checkout - Order Checkout (User Can Checkout)`, done => {\r\n            User.findOne({ where: { email: user1_Payload.email } }).then(user => {\r\n              const { id, name, email, phone } = user;\r\n              const token = jwt.sign(\r\n                {\r\n                  user: { id, name, email, phone }\r\n                },\r\n                secret,\r\n                {\r\n                  expiresIn: '2h'\r\n                }\r\n              );\r\n              chai\r\n                .request(server)\r\n                .post(`/api/v1/orders/checkout`)\r\n                .set('Authorization', `Bearer ${token}`)\r\n                .send({\r\n                  delivery_address: 'Okota Lagos'\r\n                })\r\n                .then(res => {\r\n                  expect(res).to.have.status(201);\r\n                  assert.equal(res.body.status, 'success');\r\n                  done();\r\n                })\r\n                .catch(err => console.log('POST /orders/checkout', err.message));\r\n            });\r\n          });\r\n        });\r\n    })\r\n    .catch(err => console.log(err.message));\r\n});\r\n\r\nafter(done => {\r\n  User.destroy({ where: { email: user0_Payload.email } })\r\n    .then(async () => {\r\n      await Admin.destroy({ where: { email: admin0_Payload.email } });\r\n      await Admin.destroy({ where: { email: admin1_Payload.email } });\r\n      await User.destroy({ where: { email: user1_Payload.email } });\r\n      await User.destroy({ where: { email: user0_Payload.email } });\r\n    })\r\n    .then(() => {\r\n      done();\r\n    });\r\n});\r\n"],"file":"orders_test.js"}