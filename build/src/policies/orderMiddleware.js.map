{"version":3,"sources":["../../../api/src/policies/orderMiddleware.js"],"names":["OrdersMiddleware","req","res","next","schema","mealId","Joi","number","min","required","quantity","validate","body","status","json","message","String","details","type","action","string","includes","Error","undefined","delivery_address","OrderMiddleware"],"mappings":";;;;;;;AAAA;;;;;;;;;;;;;;IAEMA,gB;;;;;;;;;;;;+CACqBC,G,EAAKC,G,EAAKC,I;;;;;;;AAEzBC,gBAAAA,M,GAAS;AACbC,kBAAAA,MAAM,EAAEC,aAAIC,MAAJ,GACLC,GADK,CACD,CADC,EAELC,QAFK,EADK;AAIbC,kBAAAA,QAAQ,EAAEJ,aAAIC,MAAJ,GACPC,GADO,CACH,CADG,EAEPC,QAFO;AAJG,iB;;uBAQTH,aAAIK,QAAJ,CAAaV,GAAG,CAACW,IAAjB,EAAuBR,MAAvB,C;;;AACND,gBAAAA,IAAI;iDACG,I;;;;;iDAEAD,GAAG,CAACW,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,kBAAAA,MAAM,EAAE,OADkB;AAE1BE,kBAAAA,OAAO,EAAEC,MAAM,CAAC,YAAMC,OAAN,CAAc,CAAd,EAAiBF,OAAlB,CAFW;AAG1BG,kBAAAA,IAAI,EAAE;AAHoB,iBAArB,C;;;;;;;;;;;;;;;;;;;;;gDAOejB,G,EAAKC,G,EAAKC,I;;;;;;;AAE1BC,gBAAAA,M,GAAS;AACbe,kBAAAA,MAAM,EAAEb,aAAIc,MAAJ,GAAaX,QAAb;AADK,iB;;uBAGTH,aAAIK,QAAJ,CAAaV,GAAG,CAACW,IAAjB,EAAuBR,MAAvB,C;;;oBACD,CAAC,UAAD,EAAa,UAAb,EAAyB,QAAzB,EAAmCiB,QAAnC,CAA4CpB,GAAG,CAACW,IAAJ,CAASO,MAArD,C;;;;;sBACG,IAAIG,KAAJ,CAAU,0BAAV,C;;;AAERnB,gBAAAA,IAAI;kDACG,I;;;;;;AAGP,oBAAI,aAAMc,OAAN,KAAkBM,SAAtB,EAAiC;AAC/BR,kBAAAA,OAAO,GAAGC,MAAM,CAAC,aAAMC,OAAN,CAAc,CAAd,EAAiBF,OAAlB,CAAhB;AACD,iBAFD,MAEO;AACLA,kBAAAA,OAAO,GAAGC,MAAM,CAAC,aAAMD,OAAP,CAAhB;AACD;;kDACMb,GAAG,CAACW,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,kBAAAA,MAAM,EAAE,KADkB;AAE1BE,kBAAAA,OAAO,EAAPA,OAF0B;AAG1BG,kBAAAA,IAAI,EAAE;AAHoB,iBAArB,C;;;;;;;;;;;;;;;;;;;;;gDAQgBjB,G,EAAKC,G,EAAKC,I;;;;;;;AAE3BC,gBAAAA,M,GAAS;AACboB,kBAAAA,gBAAgB,EAAElB,aAAIc,MAAJ,GAAaX,QAAb;AADL,iB;;uBAGTH,aAAIK,QAAJ,CAAaV,GAAG,CAACW,IAAjB,EAAuBR,MAAvB,C;;;AACND,gBAAAA,IAAI;kDACG,I;;;;;;AAGP,oBAAI,aAAMc,OAAN,KAAkBM,SAAtB,EAAiC;AAC/BR,kBAAAA,OAAO,GAAGC,MAAM,CAAC,aAAMC,OAAN,CAAc,CAAd,EAAiBF,OAAlB,CAAhB;AACD,iBAFD,MAEO;AACLA,kBAAAA,OAAO,GAAGC,MAAM,CAAC,aAAMD,OAAP,CAAhB;AACD;;kDACMb,GAAG,CAACW,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,kBAAAA,MAAM,EAAE,KADkB;AAE1BE,kBAAAA,OAAO,EAAPA,OAF0B;AAG1BG,kBAAAA,IAAI,EAAE;AAHoB,iBAArB,C;;;;;;;;;;;;;;;;;;;;;AASb,IAAMO,eAAe,GAAG,IAAIzB,gBAAJ,EAAxB;eACeyB,e","sourcesContent":["import Joi from 'joi';\r\n\r\nclass OrdersMiddleware {\r\n  async validateAddToOrder(req, res, next) {\r\n    try {\r\n      const schema = {\r\n        mealId: Joi.number()\r\n          .min(1)\r\n          .required(),\r\n        quantity: Joi.number()\r\n          .min(1)\r\n          .required()\r\n      };\r\n      await Joi.validate(req.body, schema);\r\n      next();\r\n      return true;\r\n    } catch (error) {\r\n      return res.status(400).json({\r\n        status: 'error',\r\n        message: String(error.details[0].message),\r\n        type: 'validation'\r\n      });\r\n    }\r\n  }\r\n  async validateModifyOrder(req, res, next) {\r\n    try {\r\n      const schema = {\r\n        action: Joi.string().required()\r\n      };\r\n      await Joi.validate(req.body, schema);\r\n      if (!['increase', 'decrease', 'delete'].includes(req.body.action)) {\r\n        throw new Error('Invalid Action Requested');\r\n      }\r\n      next();\r\n      return true;\r\n    } catch (error) {\r\n      let message;\r\n      if (error.details !== undefined) {\r\n        message = String(error.details[0].message);\r\n      } else {\r\n        message = String(error.message);\r\n      }\r\n      return res.status(400).json({\r\n        status: false,\r\n        message,\r\n        type: 'validation'\r\n      });\r\n    }\r\n  }\r\n\r\n  async validateOrdeCheckout(req, res, next) {\r\n    try {\r\n      const schema = {\r\n        delivery_address: Joi.string().required()\r\n      };\r\n      await Joi.validate(req.body, schema);\r\n      next();\r\n      return true;\r\n    } catch (error) {\r\n      let message;\r\n      if (error.details !== undefined) {\r\n        message = String(error.details[0].message);\r\n      } else {\r\n        message = String(error.message);\r\n      }\r\n      return res.status(400).json({\r\n        status: false,\r\n        message,\r\n        type: 'validation'\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\nconst OrderMiddleware = new OrdersMiddleware();\r\nexport default OrderMiddleware;\r\n"],"file":"orderMiddleware.js"}